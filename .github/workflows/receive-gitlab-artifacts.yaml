# .github/workflows/process-artifacts.yml
name: Process GitLab Artifacts

on:
  repository_dispatch:
    types: [gitlab_artifacts_ready]
    branches:
        - 'setup-artifaction-consumption-from-gitlab' 

jobs:
  process:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Download GitLab artifacts
        run: |
          curl --header "PRIVATE-TOKEN: ${secrets.GITLAB_TOKEN}" \
            "https://code.siemens.com/api/v4/projects/${{ github.event.client_payload.gitlab_project_id }}/jobs/artifacts/${{ github.event.client_payload.gitlab_commit_ref }}/download?job=build" \
            -o artifacts.zip
          unzip artifacts.zip
        env:
          GITLAB_TOKEN: ${{ secrets.GITLAB_TOKEN }}

      - name: Process artifacts
        run: |
          # Hier deine Verarbeitung der Artifacts
          ls -la bin/